{"version":3,"file":"state-transfer.js","sources":["../../../../.temp/packages/@ngx-universal/state-transfer/src/state-transfer.service.ts","../../../../.temp/packages/@ngx-universal/state-transfer/src/utils/json-string-tools.ts","../../../../.temp/packages/@ngx-universal/state-transfer/src/server-state-transfer.service.ts","../../../../.temp/packages/@ngx-universal/state-transfer/src/http-transfer.service.ts","../../../../.temp/packages/@ngx-universal/state-transfer/index.ts"],"sourcesContent":["// angular\r\n\nimport { Injectable } from '@angular/core';\nexport class StateTransferService {\nprivate readonly state: Map<string, any>;\nconstructor() {\r\n    this.state = new Map<string, any>();\r\n  }\n/**\n * @param {?} state\n * @return {?}\n */\ninitialize(state: Map<string, any>): void {\r\n    Object.keys(state)\r\n      .forEach(key => {\r\n        this.set(key, state[key]);\r\n      });\r\n  }\n/**\n * @param {?} key\n * @return {?}\n */\nget(key: string): any {\r\n    return this.state.get(key);\r\n  }\n/**\n * @param {?} key\n * @param {?} value\n * @return {?}\n */\nset(key: string, value: any): Map<string, any> {\r\n    return this.state.set(key, value);\r\n  }\n/**\n * @return {?}\n */\ninject(): void {\r\n    // NOTE: not implemented, needs to be overridden by subclasses\r\n  }\n/**\n * @return {?}\n */\nprotected toJson(): any {\r\n    const /** @type {?} */ obj = {};\r\n    Array.from(this.state.keys())\r\n      .forEach((key: string) => {\r\n        obj[key] = this.get(key);\r\n      });\r\n\r\n    return obj;\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction StateTransferService_tsickle_Closure_declarations() {\n/** @type {?} */\nStateTransferService.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nStateTransferService.ctorParameters;\n/** @type {?} */\nStateTransferService.prototype.state;\n}\n\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","const /** @type {?} */ jsonStringEscapeMap = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\\\\': '\\\\\\\\',\r\n  '\\'': '&#39;'\r\n};\r\n\r\nconst /** @type {?} */ jsonStringUnescapeMap = {\r\n  '&lt;': '<',\r\n  '&gt;': '>',\r\n  '&amp;': '&',\r\n  '&#39;': '\\''\r\n};\n/**\n * @param {?} str\n * @return {?}\n */\nexport function jsonStringEscape(str: string): string {\r\n  return str.replace(/[&\\<\\>\\\\']/g, e => jsonStringEscapeMap[e]);\r\n}\n/**\n * @param {?} str\n * @return {?}\n */\nexport function jsonStringUnescape(str: string): string {\r\n  return str.replace(/(&amp;)|(&lt;)|(&gt;)|(&#39;)/g, e => jsonStringUnescapeMap[e]);\r\n}\r\n","// angular\r\n\nimport { Inject, Injectable, InjectionToken, RendererFactory2, ViewEncapsulation } from '@angular/core';\r\nimport { PlatformState } from '@angular/platform-server';\r\n\r\n// module\r\n\nimport { StateTransferService } from './state-transfer.service';\r\n\r\n// utils\r\n\nimport { jsonStringEscape } from './utils/json-string-tools';\r\n\r\nexport const /** @type {?} */ STATE_ID = new InjectionToken<string>('STATE_ID');\r\nexport const /** @type {?} */ DEFAULT_STATE_ID = 'STATE';\nexport class ServerStateTransferService extends StateTransferService {\n/**\n * @param {?} stateId\n * @param {?} platformState\n * @param {?} rendererFactory\n */\nconstructor(\nprivate readonly stateId: string,\nprivate readonly platformState: PlatformState,\nprivate readonly rendererFactory: RendererFactory2) {\r\n    super();\r\n  }\n/**\n * @return {?}\n */\ninject(): void {\r\n    try {\r\n      const /** @type {?} */ document: any = this.platformState.getDocument();\r\n      const /** @type {?} */ state = JSON.stringify(this.toJson());\r\n      const /** @type {?} */ escapedState = jsonStringEscape(state);\r\n      const /** @type {?} */ renderer = this.rendererFactory.createRenderer(document, {\r\n        id: '-1',\r\n        encapsulation: ViewEncapsulation.None,\r\n        styles: [],\r\n        data: {}\r\n      });\r\n\r\n      const /** @type {?} */ body = document.body;\r\n\r\n      if (!body)\r\n        throw new Error('<body> not found in the document');\r\n\r\n      const /** @type {?} */ script = renderer.createElement('script');\r\n      renderer.setValue(script, `window['${this.stateId}'] = '${escapedState}'`);\r\n      renderer.appendChild(body, script);\r\n    } catch ( /** @type {?} */e) {\r\n      console.error(e);\r\n    }\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: undefined, decorators: [{ type: Inject, args: [STATE_ID, ] }, ]},\n{type: PlatformState, },\n{type: RendererFactory2, },\n];\n}\n\nfunction ServerStateTransferService_tsickle_Closure_declarations() {\n/** @type {?} */\nServerStateTransferService.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nServerStateTransferService.ctorParameters;\n/** @type {?} */\nServerStateTransferService.prototype.stateId;\n/** @type {?} */\nServerStateTransferService.prototype.platformState;\n/** @type {?} */\nServerStateTransferService.prototype.rendererFactory;\n}\n\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","// angular\r\n\nimport { Injectable } from '@angular/core';\r\nimport { Http, Request, RequestOptionsArgs, Response } from '@angular/http';\r\n\r\n// libs\r\n\nimport { Observable } from 'rxjs/Observable';\r\nimport'rxjs/add/observable/fromPromise';\r\nimport'rxjs/add/operator/do';\r\nimport'rxjs/add/operator/map';\r\n\r\n// module\r\n\nimport { StateTransferService } from './state-transfer.service';\nexport class HttpTransferService {\n/**\n * @param {?} http\n * @param {?} stateTransfer\n */\nconstructor(private readonly http: Http,\r\n              protected readonly stateTransfer: StateTransferService) {\r\n  }\n/**\n * @param {?} uri\n * @param {?=} options\n * @return {?}\n */\nrequest(uri: string | Request, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(uri, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.request(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?=} options\n * @return {?}\n */\nget(url: string, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(url, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.get(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?} body\n * @param {?=} options\n * @return {?}\n */\npost(url: string, body: any, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getPostData(url, body, options, (urlRes: string) => {\r\n      return this.http.post(urlRes, body, options);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?} body\n * @param {?=} options\n * @return {?}\n */\nput(url: string, body: any, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(url, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.put(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?=} options\n * @return {?}\n */\ndelete(url: string, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(url, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.delete(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?} body\n * @param {?=} options\n * @return {?}\n */\npatch(url: string, body: any, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getPostData(url, body, options, (urlRes: string) => {\r\n      return this.http.patch(urlRes, body, options);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?=} options\n * @return {?}\n */\nhead(url: string, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(url, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.head(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} url\n * @param {?=} options\n * @return {?}\n */\noptions(url: string, options?: RequestOptionsArgs): Observable<any> {\r\n    return this.getData(url, options, (urlRes: string, optionsRes: RequestOptionsArgs) => {\r\n      return this.http.options(urlRes, optionsRes);\r\n    });\r\n  }\n/**\n * @param {?} uri\n * @param {?} options\n * @param {?} callback\n * @return {?}\n */\nprivate getData(uri: string | Request, options: RequestOptionsArgs,\r\n                  callback: (uri: string | Request, options?: RequestOptionsArgs) => Observable<Response>): any {\r\n\r\n    let /** @type {?} */ url = uri;\r\n\r\n    if (typeof uri !== 'string')\r\n      url = uri.url;\r\n\r\n    const /** @type {?} */ key = url + JSON.stringify(options);\r\n\r\n    try {\r\n      return this.resolveData(key);\r\n\r\n    } catch ( /** @type {?} */e) {\r\n      return callback(uri, options)\r\n        .map(res => res.json())\r\n        .do(data => {\r\n          this.setCache(key, data);\r\n        });\r\n    }\r\n  }\n/**\n * @param {?} uri\n * @param {?} body\n * @param {?} options\n * @param {?} callback\n * @return {?}\n */\nprivate getPostData(uri: string | Request, body: any, options: RequestOptionsArgs,\r\n                      callback: (uri: string | Request, body: any, options?: RequestOptionsArgs) => Observable<Response>): any {\r\n\r\n    let /** @type {?} */ url = uri;\r\n\r\n    if (typeof uri !== 'string')\r\n      url = uri.url;\r\n\r\n    const /** @type {?} */ key = url + JSON.stringify(body) + JSON.stringify(options);\r\n\r\n    try {\r\n      return this.resolveData(key);\r\n    } catch ( /** @type {?} */e) {\r\n      return callback(uri, body, options)\r\n        .map(res => res.json())\r\n        .do(data => {\r\n          this.setCache(key, data);\r\n        });\r\n    }\r\n  }\n/**\n * @param {?} key\n * @return {?}\n */\nprivate resolveData(key: string): any {\r\n    const /** @type {?} */ data = this.getFromCache(key);\r\n\r\n    if (!data)\r\n      throw new Error();\r\n\r\n    return Observable.fromPromise(Promise.resolve(data));\r\n  }\n/**\n * @param {?} key\n * @param {?} data\n * @return {?}\n */\nprivate setCache(key: string, data: any): any {\r\n    return this.stateTransfer.set(key, data);\r\n  }\n/**\n * @param {?} key\n * @return {?}\n */\nprivate getFromCache(key: string): any {\r\n    return this.stateTransfer.get(key);\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Http, },\n{type: StateTransferService, },\n];\n}\n\nfunction HttpTransferService_tsickle_Closure_declarations() {\n/** @type {?} */\nHttpTransferService.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHttpTransferService.ctorParameters;\n/** @type {?} */\nHttpTransferService.prototype.http;\n/** @type {?} */\nHttpTransferService.prototype.stateTransfer;\n}\n\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","// angular\r\n\nimport { ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';\r\n\r\n// module\r\n\nimport { DEFAULT_STATE_ID, ServerStateTransferService, STATE_ID } from './src/server-state-transfer.service';\r\nimport { HttpTransferService } from './src/http-transfer.service';\r\nimport { StateTransferService } from './src/state-transfer.service';\r\nimport { jsonStringUnescape } from './src/utils/json-string-tools';\r\n\r\nexport {STATE_ID,DEFAULT_STATE_ID,ServerStateTransferService} from './src/server-state-transfer.service';\r\nexport {StateTransferService} from './src/state-transfer.service';\r\nexport {HttpTransferService} from './src/http-transfer.service';\n/**\n * @param {?} stateId\n * @return {?}\n */\nexport function stateTransferFactory(stateId: string): StateTransferService {\r\n  const /** @type {?} */ stateTransfer = new StateTransferService();\r\n  const /** @type {?} */ escapedState = window[stateId] || '';\r\n  const /** @type {?} */ state = JSON.parse(jsonStringUnescape(escapedState));\r\n\r\n  stateTransfer.initialize(state);\r\n\r\n  return stateTransfer;\r\n}\nexport class HttpTransferModule {\n/**\n * @return {?}\n */\nstatic forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: HttpTransferModule\r\n    };\r\n  }\n/**\n * @param {?} parentModule\n */\nconstructor(  parentModule: HttpTransferModule) {\r\n    if (parentModule)\r\n      throw new Error('HttpTransferModule already loaded; import in root module only.');\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\r\n  providers: [\r\n    HttpTransferService\r\n  ]\r\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: HttpTransferModule, decorators: [{ type: Optional }, { type: SkipSelf }, ]},\n];\n}\n\nfunction HttpTransferModule_tsickle_Closure_declarations() {\n/** @type {?} */\nHttpTransferModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHttpTransferModule.ctorParameters;\n}\n\nexport class BrowserStateTransferModule {\n/**\n * @param {?=} stateId\n * @return {?}\n */\nstatic forRoot(stateId: string = DEFAULT_STATE_ID): ModuleWithProviders {\r\n    return {\r\n      ngModule: BrowserStateTransferModule,\r\n      providers: [\r\n        {\r\n          provide: StateTransferService,\r\n          useFactory: (stateTransferFactory),\r\n          deps: [STATE_ID]\r\n        },\r\n        {\r\n          provide: STATE_ID,\r\n          useValue: stateId\r\n        }\r\n      ]\r\n    };\r\n  }\n/**\n * @param {?} parentModule\n */\nconstructor(  parentModule: BrowserStateTransferModule) {\r\n    if (parentModule)\r\n      throw new Error('BrowserStateTransferModule already loaded; import in BROWSER module only.');\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: BrowserStateTransferModule, decorators: [{ type: Optional }, { type: SkipSelf }, ]},\n];\n}\n\nfunction BrowserStateTransferModule_tsickle_Closure_declarations() {\n/** @type {?} */\nBrowserStateTransferModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nBrowserStateTransferModule.ctorParameters;\n}\n\nexport class ServerStateTransferModule {\n/**\n * @param {?=} stateId\n * @return {?}\n */\nstatic forRoot(stateId: string = DEFAULT_STATE_ID): ModuleWithProviders {\r\n    return {\r\n      ngModule: ServerStateTransferModule,\r\n      providers: [\r\n        {\r\n          provide: STATE_ID,\r\n          useValue: stateId\r\n        }\r\n      ]\r\n    };\r\n  }\n/**\n * @param {?} parentModule\n */\nconstructor(  parentModule: ServerStateTransferModule) {\r\n    if (parentModule)\r\n      throw new Error('ServerStateTransferModule already loaded; import in SERVER module only.');\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\r\n  providers: [\r\n    {\r\n      provide: StateTransferService,\r\n      useClass: ServerStateTransferService\r\n    }\r\n  ]\r\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ServerStateTransferModule, decorators: [{ type: Optional }, { type: SkipSelf }, ]},\n];\n}\n\nfunction ServerStateTransferModule_tsickle_Closure_declarations() {\n/** @type {?} */\nServerStateTransferModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nServerStateTransferModule.ctorParameters;\n}\n\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"],"names":[],"mappings":"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"}